# üöÄ –ì–û–¢–û–í–û –ö DEPLOYMENT - Telegram Shipping Bot

## ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
- ‚úÖ `MONGO_URL` - MongoDB Atlas –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ `TELEGRAM_BOT_TOKEN` - –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `SHIPSTATION_API_KEY_TEST` - –¢–µ—Å—Ç–æ–≤—ã–π API –∫–ª—é—á
- ‚úÖ `SHIPSTATION_API_KEY_PROD` - –ü—Ä–æ–¥–∞–∫—à–Ω API –∫–ª—é—á
- ‚úÖ `OXAPAY_API_KEY` - **–û–±–Ω–æ–≤–ª–µ–Ω** (AIQ2XA-A4ASEL-5HTMND-6WJ2YK)
- ‚úÖ `EMERGENT_LLM_KEY` - AI –∫–ª—é—á –¥–ª—è –±–ª–∞–≥–æ–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ `ADMIN_TELEGRAM_ID` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MongoDB
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ 9 –∫–æ–ª–ª–µ–∫—Ü–∏–π —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ: 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, 7 –∑–∞–∫–∞–∑–æ–≤, 1 —à–∞–±–ª–æ–Ω

### 3. API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ ShipStation - TEST —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ Oxapay - –ù–æ–≤—ã–π –∫–ª—é—á –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è - –†–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Telegram Bot API - Polling —Ä–µ–∂–∏–º

### 4. –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
1. ‚úÖ AI-—Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –ø–æ—Å–ª–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–∞–ª–∞–Ω—Å–µ
2. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —à—Ç–∞—Ç–∞ —É–ª—É—á—à–µ–Ω–∞ (–æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É)
3. ‚úÖ AI-—Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç "–Ω–∞—à —Å–µ—Ä–≤–∏—Å" –≤–º–µ—Å—Ç–æ "–¥–æ—Å—Ç–∞–≤–∫–∞"
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª—É—á–∞–π–Ω—ã–µ –≤–µ—Å–µ–ª—ã–µ —ç–º–æ–¥–∂–∏ (15 –ø–∞—Ä)
5. ‚úÖ Oxapay API –∫–ª—é—á –æ–±–Ω–æ–≤–ª–µ–Ω
6. ‚úÖ –§–ª–æ—É –≤—ã–±–æ—Ä–∞ —à–∞–±–ª–æ–Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
7. ‚úÖ –ö–Ω–æ–ø–∫–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —à–∞–±–ª–æ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è

### 5. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–ú–æ–π –±–∞–ª–∞–Ω—Å" - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ö†Ô∏è –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π `telegram.error.Conflict` - –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç —Ä–µ—à–µ–Ω–∏—è

## üéØ –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞ –≤—Å–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

1. **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
   - `/start` ‚Üí –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
   - `/balance` ‚Üí –ë–∞–ª–∞–Ω—Å (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)

2. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞:**
   - –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ ‚Üí –†—É—á–Ω–æ–π –≤–≤–æ–¥ ‚úÖ
   - –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ ‚Üí –ò–∑ —à–∞–±–ª–æ–Ω–∞ ‚Üí –ü—Ä–æ—Å–º–æ—Ç—Ä ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ‚úÖ

3. **–ü–ª–∞—Ç–µ–∂–∏:**
   - –û–ø–ª–∞—Ç–∞ —Å –±–∞–ª–∞–Ω—Å–∞ ‚úÖ
   - –û–ø–ª–∞—Ç–∞ –∫—Ä–∏–ø—Ç–æ–π ‚úÖ

4. **–®–∞–±–ª–æ–Ω—ã:**
   - –ü—Ä–æ—Å–º–æ—Ç—Ä ‚úÖ
   - –£–¥–∞–ª–µ–Ω–∏–µ (–∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è) ‚úÖ
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ Production —Ä–µ–∂–∏–º

–ö–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π ShipStation:

```bash
cd /app/backend
python set_api_mode.py production
sudo supervisorctl restart backend
```

## üÜò –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç –±–æ—Ç–∞:

```bash
cd /app/backend
python force_clear_bot.py
sudo supervisorctl restart backend
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:** 7
- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 5
- **–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ:** 4
- **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π:** 3 (ShipStation, Oxapay, OpenAI)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö DEPLOYMENT**
**–î–∞—Ç–∞:** 2025-11-25
**–ê–≥–µ–Ω—Ç:** E1
